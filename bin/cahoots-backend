#!/usr/bin/env node

/*
 * cahoots-backend
 *
 * Copyright Cahoots.pw
 * MIT Licensed
 *
 */

/**
 * @author André König <andre.koenig@posteo.de>
 *
 */

'use strict';

var backend = require('../')();
var pkg = require('../package.json');

var port = process.env.PORT = (process.env.PORT || 8080);

function onBoot (err) {
    if (err) {
        return console.error(err.message);
    }
    
    console.log('"%s" (v%s) is running on port "%d".', pkg.name, pkg.version, port);
}

backend.boot(onBoot);

process.on('SIGINT', function onSigint() {
    function onShutdown (err) {
        if (err) {
            return console.error('Error while shutting the backend down: ' + err.message);
        }

        console.log('Bye!');
    }

    console.log('About to shutdown ...');

    backend.shutdown(onShutdown);
});